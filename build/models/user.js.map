{"version":3,"sources":["../../src/models/user.js"],"names":["userSchema","mongoose","Schema","username","type","String","unique","required","timestamps","statics","findByLogin","login","findOne","user","email","pre","next","model","deleteMany","_id","User"],"mappings":";;;;;;AAAA;;;;;;;;AAEA,IAAMA,aAAa,IAAIC,mBAASC,MAAb,CACjB;AACEC,YAAU;AACRC,UAAMC,MADE;AAERC,YAAQ,IAFA;AAGRC,cAAU;AAHF;AADZ,CADiB,EAQjB,EAAEC,YAAY,IAAd,EARiB,CAAnB;;AAWAR,WAAWS,OAAX,CAAmBC,WAAnB;AAAA,qEAAiC,iBAAgBC,KAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACd,KAAKC,OAAL,CAAa;AAC5BT,wBAAUQ;AADkB,aAAb,CADc;;AAAA;AAC3BE,gBAD2B;;AAAA,gBAK1BA,IAL0B;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAMhB,KAAKD,OAAL,CAAa,EAAEE,OAAOH,KAAT,EAAb,CANgB;;AAAA;AAM7BE,gBAN6B;;AAAA;AAAA,6CASxBA,IATwB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAjC;;AAAA;AAAA;AAAA;AAAA;;AAYAb,WAAWe,GAAX,CAAe,QAAf,EAAyB,UAAUC,IAAV,EAAgB;AACvC,OAAKC,KAAL,CAAW,SAAX,EAAsBC,UAAtB,CAAiC,EAAEL,MAAM,KAAKM,GAAb,EAAjC,EAAqDH,IAArD;AACD,CAFD;;AAIA,IAAMI,OAAOnB,mBAASgB,KAAT,CAAe,MAAf,EAAuBjB,UAAvB,CAAb;;kBAEeoB,I","file":"user.js","sourcesContent":["import mongoose from 'mongoose';\r\n\r\nconst userSchema = new mongoose.Schema(\r\n  {\r\n    username: {\r\n      type: String,\r\n      unique: true,\r\n      required: true,\r\n    },\r\n  },\r\n  { timestamps: true }\r\n);\r\n\r\nuserSchema.statics.findByLogin = async function (login) {\r\n  let user = await this.findOne({\r\n    username: login,\r\n  });\r\n\r\n  if (!user) {\r\n    user = await this.findOne({ email: login });\r\n  }\r\n\r\n  return user;\r\n};\r\n\r\nuserSchema.pre('remove', function (next) {\r\n  this.model('Message').deleteMany({ user: this._id }, next);\r\n});\r\n\r\nconst User = mongoose.model('User', userSchema);\r\n\r\nexport default User;\r\n"]}